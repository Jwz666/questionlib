<!DOCTYPE html>
<html lang="en" >
<head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <title>TBS-data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- DashForge CSS -->
    <link href="../../lib/select2/css/select2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/dashforge.css">
    <link rel="stylesheet" href="../../assets/css/dashforge.dashboard.css">
    <link rel="stylesheet" href="../../assets/css/auth.css">
</head>
<body class="page-profile">

<header class="navbar navbar-header navbar-header-fixed">
    <div class="navbar-brand">
        <img src="../../assets/img/TBS%20logo.png" alt="">
    </div><!-- navbar-brand -->
    <div class="navbar-right">
        <div class="dropdown dropdown-profile">
            <a href="" class="dropdown-link" data-toggle="dropdown" data-display="static">
                <div class="avatar avatar-sm"><img src="https://via.placeholder.com/500" class="rounded-circle" alt="">
                </div>
            </a><!-- dropdown-link -->
            <div class="dropdown-menu dropdown-menu-right tx-13">
                <div class="avatar avatar-lg mg-b-15"><img src="https://via.placeholder.com/500" class="rounded-circle"
                                                           alt=""></div>
                <h6 class="tx-semibold mg-b-5">Katherine Pechon</h6>
                <a href="page-signin.html" class="dropdown-item"><i data-feather="log-out"></i>Sign Out</a>
            </div><!-- dropdown-menu -->
        </div><!-- dropdown -->
    </div><!-- navbar-right -->
</header><!-- navbar -->

<div class="content content-fixed">
    <div class="container pd-x-0 pd-lg-x-10 pd-xl-x-0">
        <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
            <div>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                        <li class="breadcrumb-item"><a href="#">题库管理</a></li>
                        <li class="breadcrumb-item active" aria-current="page">题目列表</li>
                    </ol>
                </nav>
                <div class="search-form">
                    <input type="search" class="form-control" placeholder="搜索">
                    <button class="btn" type="button"><i data-feather="search"></i></button>
                </div>
            </div>
            <div class="d-none d-md-block" style="margin-top: 28px;">
                <button class="btn btn-sm pd-x-15 btn-white btn-uppercase"><i data-feather="save"
                                                                              class="wd-10 mg-r-5"></i> 下载模板
                </button>
                <a href="#modalBillingInfo" data-toggle="modal"
                   class="outline-none btn btn-sm btn-primary btn-uppercase">
                    <i data-feather="upload" class="wd-10 mg-r-5"></i> 导入</a>
                <button class="btn btn-sm pd-x-15 btn-primary btn-uppercase mg-l-5" onclick="add()"><i data-feather="sliders"
                                                                                       class="wd-10 mg-r-5"></i> 新增
                </button>
            </div>
        </div>
        <div class="stepContent card ovf">
            <div class="summaryAreaPart">
                <div class="col-xs-12">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>编号</th>
                                <th>题干</th>
                                <th>题目类型</th>
                                <th>录入时间</th>
                                <th>操作</th>
                                <th>状态</th>
                            </tr>
                            </thead>
                            <tbody id="questionList">
                            <tr >

                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <nav aria-label="Page navigation example" style="overflow: hidden;">
            <ul class="pagination mg-b-0 mg-t-30" style="float: right;">
                <li class="item " onclick="lastPage()">
                    <a class="page-link page-link-icon" href="#">
                        <i data-feather="chevron-left"></i>
                    </a>
                </li>

                <li class="item" id="nextPage" onclick="nextPage()"><a class="page-link page-link-icon" href="#"><i
                        data-feather="chevron-right"></i></a></li>
            </ul>
        </nav>
    </div><!-- container -->
</div><!-- content -->


<footer class="footer">
</footer>
<div class="modal fade" id="modalBillingInfo" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-dialog-centered wd-sm-650" role="document">
        <div class="modal-content">
            <div class="modal-header pd-y-20 pd-x-20 pd-sm-x-30">
                <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </a>
                <div class="media align-items-center">
                    <div class="media-body">
                        <h4 class="tx-18 tx-sm-20 mg-b-2">上传文件</h4>
                    </div>
                </div><!-- media -->
            </div><!-- modal-header -->
            <div class="modal-body pd-sm-t-30 pd-sm-b-40 pd-sm-x-30">

                <div class="form-group">
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="customFile">
                        <label class="custom-file-label" for="customFile">选择文件</label>
                    </div>
                </div>

            </div><!-- modal-body -->
            <div class="modal-footer pd-x-20 pd-y-15">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary">保存</button>
            </div>


        </div><!-- modal-content -->
    </div><!-- modal-dialog -->
</div>

<script src="../../lib/jquery/jquery.min.js"></script>
<script src="../../lib/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../../lib/feather-icons/feather.min.js"></script>
<script src="../../lib/perfect-scrollbar/perfect-scrollbar.min.js"></script>
<script src="../../assets/js/dashforge.js"></script>
<script src="../../assets/js/dashforge.sampledata.js"></script>
<script src="../../assets/js/main.js"></script>
<script src="../../lib/select2/js/select2.min.js"></script>

<script>
    $(function () {

       getData();


        $('.select2').select2({
            placeholder: '添加搜索标签',
            maximumSelectionLength: 5,
            allowClear: true
        });
    });

    totalPage = 0;
    currentPageIndex=0;
    function getData(pageInfo={}) {
        if(pageInfo.page==null || pageInfo.page == undefined || pageInfo.page=='') {
            pageInfo.page=1;
            currentPageIndex=1;
        }


        pageInfo.size=20;
        $.ajax({
            // async : false,    //表示请求是否异步处理
            type : "get",    //请求类型
            url : "/baseQuestions/getQuestionByPage",//请求的 URL地址
            data: pageInfo,
            dataType : "json",//返回的数据类型
            success: function (data) {
                console.log(data);  //在控制台打印服务器端返回的数据
                if(data.code=='200') {
                    var page=data.body;
                    var questionList=data.body.records;
                    if(questionList.length != 0) {
                        for(var i=0;i<questionList.length;i++) {
                            $("#questionList").append(' <tr >\n' +
                                '                                <td >'+questionList[i].id+'</td>\n' +
                                '                                <td >'+questionList[i].content+'</td>\n' +
                                '                                <td>'+questionTypeFormatter(questionList[i].questionType)+'</td>\n' +
                                '                                <td>'+timeStamp2String(questionList[i].createdAt)+'</td>\n' +
                                '                                <td  onclick="edit('+questionList[i].id+')">\n' +
                                '                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"\n' +
                                '                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"\n' +
                                '                                         stroke-linejoin="round" class="feather feather-sliders wd-10 mg-r-5">\n' +
                                '                                        <line x1="4" y1="21" x2="4" y2="14"></line>\n' +
                                '                                        <line x1="4" y1="10" x2="4" y2="3"></line>\n' +
                                '                                        <line x1="12" y1="21" x2="12" y2="12"></line>\n' +
                                '                                        <line x1="12" y1="8" x2="12" y2="3"></line>\n' +
                                '                                        <line x1="20" y1="21" x2="20" y2="16"></line>\n' +
                                '                                        <line x1="20" y1="12" x2="20" y2="3"></line>\n' +
                                '                                        <line x1="1" y1="14" x2="7" y2="14"></line>\n' +
                                '                                        <line x1="9" y1="8" x2="15" y2="8"></line>\n' +
                                '                                        <line x1="17" y1="16" x2="23" y2="16"></line>\n' +
                                '                                    </svg>\n' +
                                '                                </td>\n' +
                                '                                <td><input type="checkbox"></td>\n' +
                                '                            </tr>');
                        }
                    }
                    totalPage=page.pages;
                    var showPage=totalPage;
                    if(totalPage>3) {
                        showPage=3;
                    }
                    $(".page-item").remove();
                    for (i = 0; i < totalPage; i++) {
                        var current = i + 1;
                        $("#nextPage").before('<li class="page-item" data-id=' + current + '><a class="page-link" href="#" onclick="pageChange(this)">' + current + '</a></li>');

                    }
                }
                if(data.code=='500') {
                    alert(data.message);
                }
            },
            error:function (data) {
                alert(data.message);
            }

        });
    }

    function edit(id) {
        var  pageInfo={};
        pageInfo.page=1;
        pageInfo.size=10;
        pageInfo.id=id;
        var url=encodeURI("math-exedit.html?questionId="+JSON.stringify(pageInfo));
        window.location.href = url;


    }
    function add() {
        window.location.href="math-exedit.html";
    }
    function pageChange(target) {
        currentPageIndex=$(target).text();
        console.log(currentPageIndex);
        var pageInfo={};
        pageInfo.page=currentPageIndex;
        getData(pageInfo);
        $("#questionList").empty();

    }

    function nextPage() {
       var nextPage=parseInt(currentPageIndex)+1;
       console.log(nextPage);
       if(nextPage>totalPage) {
           return;
       }
       console.log(nextPage);
        var pageInfo={};
        pageInfo.page=nextPage;
        getData(pageInfo);
        $("#questionList").empty();

    }
    function lastPage() {

        var lastPage=currentPageIndex-1;
        console.log(lastPage);
        if(lastPage<0) {
            return;
        }
        console.log(lastPage);
        var pageInfo={};
        pageInfo.page=lastPage;
        getData(pageInfo);
        $("#questionList").empty();

    }



</script>

</body>
</html>
